# 浏览器演进过程
浏览器是多进程的，以 chorme 为例，打开一个 tab 页，可能会启动下面几个进程
- GPU 进程
- render process
- browser process
- plugin process

# 单进程浏览器时代
据说早在 2007 年之前，市面上的浏览器都是单进程的，这意味着 插件、js 执行、页面程序、页面渲染、storage、网络请求如此多的模块都运行在一个进程里面。
这样会导致，不流畅、不稳定、不安全的一个主要因素
- 不稳定
早期 web 视频， Web 游戏等各种强大的功能都是通过浏览器插件来实现的。然而插件是最容易出现问题的模块。这意味只要 一个 插件运行崩溃，整个页面就会崩溃
渲染引擎也是不稳定的，如果一个 js 代码执行逻辑时间复杂，js 执行崩溃，则有可能引起渲染引擎的崩溃
- 不流畅
单线程以为页面所有的渲染模块,jS 代码执行模块都运行在一个线程中。如果 一段 js 代码是一个死循环。或者是执行逻辑较长，它会独占整个线程。这样会导致其他模块没有机会执行。因此页面会变卡顿
- 不安全
一个是插件，它可以是使用 c/c++ 编写。通过插件可以获取到操作系统，因此当一个插件运行时，这个插件可以完全操作你的操作系统，获取用户密码。释放病毒，恶意揣改
一个是页面脚本。可以通过浏览器的漏洞来获取系统权限。获取系统权限后也可以对电脑作一些恶意的事情

# 早期多进程架构
chrome 的页面是运行在单独的渲染进程中。同时页面的插件也是运行在单独的插件进程中。而进程间的通信是使用的 IPC 机制进行通行
渲染进程负责 解析 渲染 js 代码执行 合成页面

- 如何解决不稳定
由于进程间是相互隔离的，每个 tab 页都有自己的渲染进程，因此当某个页面运行崩溃，也只是当前页面崩溃，并不会影响其他页面
- 如何解决不流畅
JS 的执行也是在渲染进程中。所以即使 js 阻塞了渲染进程也只是影响了当前 tab 页的渲染进程
- 如何解决不安全
利用多进程额外的好处就是可以使用沙箱，沙箱就是操作系统给进程上了一把锁。沙箱里面的进程可以运行，但是不能在硬盘上读取任何数据。也不能在敏感位置读取数据。例如文档和桌面。 chrome 吧渲染进程和 插件进程锁在沙箱里面

# 目前多进程架构
最新的 chrome 浏览器包括： 一个浏览器进程 一个 GPU 进程 一个网络进程 多个渲染进程 以及多个插件进程
分别介绍下几个进程：
浏览器进程： 负责 界面显示，用户交互，子进程管理，同时提供存储能力
GPU 进程： 最开始是为了实现 3d css 效果。只是后面后面 chrome 的 UI 界面都是用 GPU 绘制。这使得 GPU 更为普遍
渲染进程： 每个tab 页面都有自己的渲染进程，它是运行在沙箱里面。负责将 html css js 转换为与用户可交互的页面，排版引擎和 js v8 引擎都在 渲染进程里面。
网络进程：负责网络资源的加载
插件进程： 负责插件的运行
因此打开以为。至少需要 4 个进程。一个网络进程，一个渲染进程，一个浏览器进程，一个 GPU 进程
多进程模型也会存在一些问题
更高的资源占比
更复杂的体系

# 面向服务架构
为了解决这些问题 2016 年， chrome 官方团队使用了 “面向服务的架构”。它的意思是将各个模块设计成独立的服务。每个服务都可以独立的进程中运行。访问服务必须使用定义好的接口来访问，通过 IPC 通信

# 问题
- 为什么之前的单进程不能放在沙箱中运行？
如果一个进程使用了安全沙箱后，该进程对于操作系统的权限就会受到限制。而这些限制包括对系统的某些文件进行访问。而这些权限是浏览器的主进程需要的，这也是为什么浏览器主线程不能使用安全沙箱